<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to `threesixtygiving` • threesixtygiving</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to `threesixtygiving`">
<meta property="og:description" content="threesixtygiving">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">threesixtygiving</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://docs.evanodell.com" class="external-link">Docs Home</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/introduction.html">Introduction</a>
</li>
<li>
  <a href="https://docs.evanodell.com" class="external-link">All Packages</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EvanOdell/threesixtygiving" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://evanodell.com" class="external-link">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to
<code>threesixtygiving</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/evanodell/threesixtygiving/blob/HEAD/../docs/vignettes/introduction.Rmd" class="external-link"><code>../docs/vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>This package provides tools to access and process data from <a href="https://www.threesixtygiving.org/" class="external-link">360Giving</a>, a data standard
for publishing information about charitable grant giving in the UK. The
ability to search for and query different data is similar to the <a href="https://grantnav.threesixtygiving.org/" class="external-link">GrantNav</a> tool created
by 360Giving. There are several advantages to using the software package
instead of GrantNav:</p>
<ol style="list-style-type: decimal">
<li><p>It lets you retrieve 360Giving data, search and summarise that
data, create charts and tables entirely within R.</p></li>
<li><p>It gives you access to the raw data provided by funders. The
360Giving standard allows for optional information that is not provided
by most funders or included in GrantNav. This information can be useful
to fundraising managers in some situations, as well as to researchers
wanting to understand the size, scope and approaches to charitable trust
giving in the UK.</p></li>
<li><p><code>threesixtygiving</code> returns data in types and
structures designed for R.</p></li>
</ol>
<p>The example below shows the average size of grants given by various
funders:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.evanodell.com/threesixtygiving" class="external-link">threesixtygiving</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co">## A package used to manipulate and process data</span>

<span class="co"># Download all the grant data available.</span>
<span class="co"># It comes out in a list of tibbles but that's not a problem:</span>
<span class="va">grants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsg_all_grants.html">tsg_all_grants</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">10</span>, retries <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> 

<span class="co"># Get just the core data required by the 360Giving standard.</span>
<span class="co"># Convert that list of tibbles into a tidy format:</span>
<span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsg_core_data.html">tsg_core_data</a></span><span class="op">(</span><span class="va">grants</span><span class="op">)</span> 

<span class="va">avg_size</span> <span class="op">&lt;-</span> <span class="va">all_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co">#This %&gt;% thing is a called a pipe. Pipes are love. Pipes are life.</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">currency</span> <span class="op">==</span> <span class="st">"GBP"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Filter out non-£ data</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">funding_org_name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Group all the funders together</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">amount_awarded</span><span class="op">)</span><span class="op">)</span> <span class="co"># Get the average of given value for each group, kinda like =AVERAGEIFS in Excel.</span>

<span class="va">avg_size</span>

<span class="co"># # A tibble: 109 x 2</span>
<span class="co">#    funding_org_name                             avg</span>
<span class="co">#    &lt;chr&gt;                                      &lt;dbl&gt;</span>
<span class="co">#  1 A B Charitable Trust                      13714.</span>
<span class="co">#  2 Barrow Cadbury Trust                      35889.</span>
<span class="co">#  3 BBC Children in Need                      55968.</span>
<span class="co">#  4 Birmingham City Council                   32097.</span>
<span class="co">#  5 Calouste Gulbenkian Foundation, UK Branch 34352.</span>
<span class="co">#  6 Camden Giving                             18254.</span>
<span class="co">#  7 Cheshire Community Foundation              6027.</span>
<span class="co">#  8 City Bridge Trust                         81381.</span>
<span class="co">#  9 Cloudesley                                14441.</span>
<span class="co"># 10 Co-operative Group                         3238.</span>
<span class="co"># # ... with 99 more rows</span></code></pre></div>
<p>The <code><a href="../reference/tsg_all_grants.html">tsg_all_grants()</a></code> function retrieves all the grant
data. And if data isn’t available, or there is a downloading error, it
will print a message warning you. No more silently failing downloads.
There is even a <code><a href="../reference/tsg_missing.html">tsg_missing()</a></code> function, which will take the
output of <code><a href="../reference/tsg_all_grants.html">tsg_all_grants()</a></code> and tell you what’s missing.</p>
<p>Say you want to include all the grants that are in currencies other
than pounds, but convert their value to pounds? In the example below I
show a way to do that where I just looked up the currency conversion
rates on my phone and changed the currency based on that, but you could
also write some code that takes the currency code, the award date, and
passes them to the <a href="https://fixer.io" class="external-link uri">https://fixer.io</a> currency conversion service using the
<a href="https://cran.r-project.org/package=fixerapi" class="external-link"><code>fixerapi</code></a>
package, which provided you have the right account type, will convert
the currency value to pound using the conversion rate on the day the
grant was awarded.</p>
<div class="section level2">
<h2 id="retrieve-all-grants">Retrieve all grants<a class="anchor" aria-label="anchor" href="#retrieve-all-grants"></a>
</h2>
<p>Below are all the R packages that I’m using create the graphs and
such in this article.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.evanodell.com/threesixtygiving" class="external-link">threesixtygiving</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>First, I’m going to retrieve all the grant data. The
<code>timeout = 8</code> means I’m having the function give up trying to
retrieve data after 8 seconds for each file, and
<code>retries = 1</code> means it is only going to retry failed
retrievals once, then it will give up and move on to retrieve the next
data set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsg_all_grants.html">tsg_all_grants</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">8</span>, retries <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Because of my minimal timeout and retries, as well as possible other
problems with how organisations configure their servers, there are some
datasets missing:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tsg_missing.html">tsg_missing</a></span><span class="op">(</span><span class="va">grants</span><span class="op">)</span>

<span class="co"># # A tibble: 7 x 14</span>
<span class="co">#   title description identifier license license_name issued modified download_url access_url data_type</span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;    </span>
<span class="co"># 1 Gran~ ""          a001p0000~ https:~ Creative Co~ 2019-~ 2019-11~ https://jof~ https://j~ xlsx     </span>
<span class="co"># 2 Gran~ ""          a00240000~ https:~ Creative Co~ 2017-~ 2018-08~ https://pea~ https://p~ xlsx     </span>
<span class="co"># 3 Gran~ ""          a00240000~ https:~ Creative Co~ 2017-~ 2018-08~ https://pea~ https://p~ xlsx     </span>
<span class="co"># 4 Gran~ ""          a001p0000~ https:~ Creative Co~ 2018-~ 2019-03~ https://pea~ https://p~ xlsx     </span>
<span class="co"># 5 Gran~ ""          a001p0000~ https:~ Creative Co~ 2018-~ 2019-08~ https://tud~ https://t~ xlsx     </span>
<span class="co"># 6 True~ ""          a00240000~ https:~ Creative Co~ 2016-~ 2018-08~ http://ods.~ http://ww~ unknown  </span>
<span class="co"># 7 Wood~ ""          a001p0000~ https:~ Creative Co~ 2017-~ 2018-08~ http://ods.~ http://ww~ unknown  </span>
<span class="co"># # ... with 4 more variables: publisher_name &lt;chr&gt;, publisher_website &lt;chr&gt;, publisher_logo &lt;chr&gt;,</span>
<span class="co"># #   publisher_prefix &lt;chr&gt;</span></code></pre></div>
<p>However, we know they are missing, and we can retry downloading just
them if needed using the <code><a href="../reference/tsg_specific_df.html">tsg_specific_df()</a></code> function. But
I’ll ignore them for now.</p>
</div>
<div class="section level2">
<h2 id="core-data">Core data<a class="anchor" aria-label="anchor" href="#core-data"></a>
</h2>
<p><code>tsg_all_grants</code> returns a list of tibbles, due to
differences in the data provided by each funder.
<code>tsg_core_data</code> returns a tibble with the 10 columns in the
<a href="https://standard.threesixtygiving.org/en/latest/#" class="external-link">360Giving
Open Standard</a>, plus the publisher prefix used to identify each
funder. <code><a href="../reference/tsg_process_data.html">tsg_process_data()</a></code> converts a list of tibbles into
a single tibble, preserving all columns (with an option to only preserve
columns where a minimum proportion have data). In the case below I have
converted non-GBP currencies to GBP on the rates on 2020-01-17.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsg_core_data.html">tsg_core_data</a></span><span class="op">(</span><span class="va">grants</span><span class="op">)</span>

<span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>amount_awarded <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
    <span class="va">currency</span> <span class="op">==</span> <span class="st">"USD"</span> <span class="op">~</span> <span class="va">amount_awarded</span><span class="op">/</span><span class="fl">1.3044</span>, <span class="co">## rate on 2020-01-17</span>
    <span class="va">currency</span> <span class="op">==</span> <span class="st">"CAD"</span> <span class="op">~</span> <span class="va">amount_awarded</span><span class="op">/</span><span class="fl">1.7017</span>, 
    <span class="va">currency</span> <span class="op">==</span> <span class="st">"CHF"</span> <span class="op">~</span> <span class="va">amount_awarded</span><span class="op">/</span><span class="fl">1.2630</span>, 
    <span class="va">currency</span> <span class="op">==</span> <span class="st">"EUR"</span> <span class="op">~</span> <span class="va">amount_awarded</span><span class="op">/</span><span class="fl">1.1750</span>,
    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">amount_awarded</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">funding_org_name</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,
            amount_awarded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">amount_awarded</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>avg <span class="op">=</span> <span class="va">amount_awarded</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="processing-data">Processing data<a class="anchor" aria-label="anchor" href="#processing-data"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">proc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsg_process_data.html">tsg_process_data</a></span><span class="op">(</span><span class="va">grants</span><span class="op">)</span> 

<span class="va">proc_amount_df</span> <span class="op">&lt;-</span> <span class="va">proc_df</span>  <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">identifier</span>, <span class="va">title</span>, <span class="va">description</span>, <span class="va">funding_org_name</span>,
         <span class="va">amount_awarded</span>, <span class="va">amount_applied_for</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_at</a></span><span class="op">(</span>.vars <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">amount_awarded</span>, <span class="va">amount_applied_for</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="va">amount_awarded</span><span class="op">-</span><span class="va">amount_applied_for</span>,
         percentage_of <span class="op">=</span> <span class="va">amount_awarded</span><span class="op">/</span><span class="va">amount_applied_for</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">amount_applied_for</span><span class="op">)</span>, <span class="va">amount_applied_for</span> <span class="op">&gt;</span> <span class="fl">2500</span>,
         <span class="va">amount_awarded</span> <span class="op">&gt;</span> <span class="fl">2500</span>,
         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">percent_rank</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0.02</span> <span class="op">&amp;</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html" class="external-link">percent_rank</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0.98</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co">## remove outliers</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span><span class="op">)</span>

<span class="va">count0</span> <span class="op">&lt;-</span> <span class="va">proc_amount_df</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">difference</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span>
  
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">proc_amount_df</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">difference</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>,
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">difference</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">4000</span>,
        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">comma</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
                       <span class="st">" applications awarded exact amount applied for"</span><span class="op">)</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">count0</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_dollar.html" class="external-link">dollar_format</a></span><span class="op">(</span>prefix <span class="op">=</span> <span class="st">"£"</span><span class="op">)</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20000</span>, <span class="op">-</span><span class="fl">10000</span>, <span class="op">-</span><span class="fl">5000</span>, <span class="op">-</span><span class="fl">2500</span>,
                                <span class="fl">0</span>, <span class="fl">2500</span>, <span class="fl">5000</span>, <span class="fl">7500</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Difference between Award and Application Amount"</span>,
       y <span class="op">=</span> <span class="st">"Number of Grants"</span>,
       caption <span class="op">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span><span class="op">)</span>

<span class="va">p4</span></code></pre></div>
<p><img src="grant-diff-value.png"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">proc_amount_df</span> <span class="op"><a href="https://purrr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">difference</span> <span class="op">!=</span> <span class="fl">0</span>, <span class="va">percentage_of</span> <span class="op">!=</span> <span class="cn">Inf</span><span class="op">)</span>,
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">percentage_of</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_label_repel</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">3000</span>, hjust <span class="op">=</span> <span class="fl">1</span>,
        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">comma</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
                       <span class="st">" applications awarded exact amount applied for"</span><span class="op">)</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">count0</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">percent</a></span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Award size as percentage of amount applied for"</span>,
       y <span class="op">=</span> <span class="st">"Number of Grants"</span>,
       caption <span class="op">=</span> <span class="st">"(c) Evan Odell | Disability Rights UK | 2020 | CC-BY-SA
       Data from 360Giving"</span><span class="op">)</span>

<span class="va">p5</span></code></pre></div>
<p><img src="grant-diff-perc.png"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://evanodell.com" class="external-link">Evan Odell</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
